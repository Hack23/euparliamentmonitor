<p align="center">
  <img src="https://hack23.com/icon-192.png" alt="Hack23 Logo" width="192" height="192">
</p>

<h1 align="center">ğŸ”„ EU Parliament Monitor â€” Flowcharts</h1>

<p align="center">
  <strong>Process & Data Flow Documentation for European Parliament Intelligence</strong><br>
  <em>ğŸ“ˆ Security Flows â€¢ ğŸ”„ CI/CD Pipeline â€¢ ğŸ“Š Data Processing</em>
</p>

<p align="center">
  <a href="#"><img src="https://img.shields.io/badge/Owner-CEO-0A66C2?style=for-the-badge" alt="Owner"/></a>
  <a href="#"><img src="https://img.shields.io/badge/Version-1.1-555?style=for-the-badge" alt="Version"/></a>
  <a href="#"><img src="https://img.shields.io/badge/Effective-2026--02--20-success?style=for-the-badge" alt="Effective Date"/></a>
  <a href="#"><img src="https://img.shields.io/badge/Review-Quarterly-orange?style=for-the-badge" alt="Review Cycle"/></a>
</p>

**ğŸ“‹ Document Owner:** CEO | **ğŸ“„ Version:** 1.1 | **ğŸ“… Last Updated:**
2026-02-21 (UTC)  
**ğŸ”„ Review Cycle:** Quarterly | **â° Next Review:** 2026-05-24

---

## ğŸ“š Architecture Documentation Map

<div class="documentation-map">

| Document                                                            | Focus           | Description                                    | Documentation Link                                                                                     |
| ------------------------------------------------------------------- | --------------- | ---------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| **[Architecture](ARCHITECTURE.md)**                                 | ğŸ›ï¸ Architecture | C4 model showing current system structure      | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/ARCHITECTURE.md)                 |
| **[Future Architecture](FUTURE_ARCHITECTURE.md)**                   | ğŸ›ï¸ Architecture | C4 model showing future system structure       | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_ARCHITECTURE.md)          |
| **[Mindmaps](MINDMAP.md)**                                          | ğŸ§  Concept      | Current system component relationships         | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/MINDMAP.md)                      |
| **[Future Mindmaps](FUTURE_MINDMAP.md)**                            | ğŸ§  Concept      | Future capability evolution                    | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_MINDMAP.md)               |
| **[SWOT Analysis](SWOT.md)**                                        | ğŸ’¼ Business     | Current strategic assessment                   | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/SWOT.md)                         |
| **[Future SWOT Analysis](FUTURE_SWOT.md)**                          | ğŸ’¼ Business     | Future strategic opportunities                 | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_SWOT.md)                  |
| **[Data Model](DATA_MODEL.md)**                                     | ğŸ“Š Data         | Current data structures and relationships      | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/DATA_MODEL.md)                   |
| **[Future Data Model](FUTURE_DATA_MODEL.md)**                       | ğŸ“Š Data         | Enhanced European Parliament data architecture | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_DATA_MODEL.md)            |
| **[Flowcharts](FLOWCHART.md)**                                      | ğŸ”„ Process      | Current data processing workflows              | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FLOWCHART.md)                    |
| **[Future Flowcharts](FUTURE_FLOWCHART.md)**                        | ğŸ”„ Process      | Enhanced AI-driven workflows                   | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_FLOWCHART.md)             |
| **[State Diagrams](STATEDIAGRAM.md)**                               | ğŸ”„ Behavior     | Current system state transitions               | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/STATEDIAGRAM.md)                 |
| **[Future State Diagrams](FUTURE_STATEDIAGRAM.md)**                 | ğŸ”„ Behavior     | Enhanced adaptive state transitions            | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_STATEDIAGRAM.md)          |
| **[Security Architecture](SECURITY_ARCHITECTURE.md)**               | ğŸ›¡ï¸ Security     | Current security implementation                | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/SECURITY_ARCHITECTURE.md)        |
| **[Future Security Architecture](FUTURE_SECURITY_ARCHITECTURE.md)** | ğŸ›¡ï¸ Security     | Security enhancement roadmap                   | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_SECURITY_ARCHITECTURE.md) |
| **[Threat Model](THREAT_MODEL.md)**                                 | ğŸ¯ Security     | STRIDE threat analysis                         | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/THREAT_MODEL.md)                 |
| **[Classification](CLASSIFICATION.md)**                             | ğŸ·ï¸ Governance   | CIA classification & BCP                       | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/CLASSIFICATION.md)               |
| **[CRA Assessment](CRA-ASSESSMENT.md)**                             | ğŸ›¡ï¸ Compliance   | Cyber Resilience Act                           | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/CRA-ASSESSMENT.md)               |
| **[Workflows](WORKFLOWS.md)**                                       | âš™ï¸ DevOps       | CI/CD documentation                            | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/WORKFLOWS.md)                    |
| **[Future Workflows](FUTURE_WORKFLOWS.md)**                         | ğŸš€ DevOps       | Planned CI/CD enhancements                     | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FUTURE_WORKFLOWS.md)             |
| **[Business Continuity Plan](BCPPlan.md)**                          | ğŸ”„ Resilience   | Recovery planning                              | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/BCPPlan.md)                      |
| **[Financial Security Plan](FinancialSecurityPlan.md)**             | ğŸ’° Financial    | Cost & security analysis                       | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/FinancialSecurityPlan.md)        |
| **[End-of-Life Strategy](End-of-Life-Strategy.md)**                 | ğŸ“¦ Lifecycle    | Technology EOL planning                        | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/End-of-Life-Strategy.md)         |
| **[Unit Test Plan](UnitTestPlan.md)**                               | ğŸ§ª Testing      | Unit testing strategy                          | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/UnitTestPlan.md)                 |
| **[E2E Test Plan](E2ETestPlan.md)**                                 | ğŸ” Testing      | End-to-end testing                             | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/E2ETestPlan.md)                  |
| **[Performance Testing](performance-testing.md)**                   | âš¡ Performance  | Performance benchmarks                         | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/performance-testing.md)          |
| **[Security Policy](SECURITY.md)**                                  | ğŸ”’ Security     | Vulnerability reporting & security policy      | [View Source](https://github.com/Hack23/euparliamentmonitor/blob/main/SECURITY.md)                     |

</div>

---

## ğŸ“‹ Overview

This document provides detailed process flow diagrams showing security controls,
data flows, and decision points in the EU Parliament Monitor platform.

---

## ğŸ›¡ï¸ ISMS Policy Alignment

This document aligns with Hack23's Information Security Management System (ISMS) policies and ISO 27001:2022 controls. All flowcharts demonstrate implementation of security controls required by these policies.

### Policy Mapping

| ISMS Policy | ISO 27001 Control | Document Section | Description |
|-------------|-------------------|------------------|-------------|
| [Information Security Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Information_Security_Policy.md) | A.5.1 | All sections | Overarching security governance framework |
| [Secure Development Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Secure_Development_Policy.md) | A.8.25, A.8.28 | News Generation Security Flow, CI/CD Security Pipeline | Secure coding practices, input validation, code review |
| [Access Control Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Access_Control_Policy.md) | A.5.15, A.5.18 | MCP Client Connection Security Flow | Authentication, authorization, least privilege |
| [Vulnerability Management Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Vulnerability_Management_Policy.md) | A.8.8 | Vulnerability Management Workflow | Vulnerability scanning, remediation, patch management |
| [Incident Response Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Incident_Response_Policy.md) | A.5.24, A.5.25, A.5.26 | Incident Response Flow | Detection, response, recovery, post-incident review |
| [Change Management Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Change_Management_Policy.md) | A.8.32 | CI/CD Security Pipeline, Release Workflow | Controlled deployments, testing, approval gates |
| [Cryptography Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Cryptography_Policy.md) | A.8.24 | Content Delivery Security Flow, Deployment Security Flow | TLS 1.3, HTTPS-only, cryptographic signatures |

### Key Security Principles Demonstrated

1. **Defense in Depth**: Multiple security layers (validation, sanitization, encoding, CSP)
2. **Least Privilege**: Minimal permissions for GitHub Actions, MCP connections
3. **Secure by Default**: HTTPS-only, CSP enforcement, input validation at every stage
4. **Fail Secure**: Fallback content on validation failures, graceful degradation
5. **Separation of Duties**: Automated checks, required approvals, independent verification
6. **Continuous Monitoring**: Dependabot, CodeQL, npm audit, health checks
7. **Incident Response**: Defined severity levels, escalation paths, post-mortem reviews
8. **Supply Chain Security**: SBOM generation, SLSA attestations, dependency scanning

### Compliance Framework Coverage

- **ISO 27001:2022**: Controls A.5.1, A.5.15, A.5.18, A.5.24, A.5.25, A.5.26, A.8.8, A.8.24, A.8.25, A.8.28, A.8.32
- **NIST CSF 2.0**: Identify (ID.RA, ID.SC), Protect (PR.AC, PR.DS, PR.IP), Detect (DE.CM), Respond (RS.AN, RS.MI), Recover (RC.RP)
- **CIS Controls v8.1**: Controls 1, 4, 6, 8, 10, 16, 18
- **GDPR**: Article 25 (Data protection by design), Article 32 (Security of processing)
- **NIS2 Directive**: Risk management, incident handling, supply chain security
- **EU Cyber Resilience Act**: Secure by default, vulnerability disclosure, security updates

---

## ğŸ” News Generation Security Flow

```mermaid
flowchart TD
    Start[ğŸš€ GitHub Actions Trigger<br/>Schedule: 06:00 UTC<br/>Manual: workflow_dispatch] --> CheckMCP{ğŸ”Œ MCP Server<br/>Available?}

    CheckMCP -->|âœ… Yes| ConnectMCP[ğŸ”— Connect to EP MCP Server<br/>stdio/localhost]
    CheckMCP -->|âŒ No| Fallback[âš ï¸ Use Placeholder Content<br/>Log Error]

    ConnectMCP --> RetryCheck{ğŸ”„ Connection<br/>Successful?}
    RetryCheck -->|âŒ No| RetryCount{Retry < 3?}
    RetryCount -->|âœ… Yes| BackoffWait[â³ Exponential Backoff<br/>Wait 1s, 2s, 4s]
    BackoffWait --> ConnectMCP
    RetryCount -->|âŒ No| Fallback

    RetryCheck -->|âœ… Yes| FetchData[ğŸ“¥ Fetch Parliamentary Data<br/>Plenary Sessions<br/>Committee Meetings<br/>Documents]

    FetchData --> ValidateSchema{âœ… Validate<br/>JSON Schema?}
    ValidateSchema -->|âŒ Invalid| LogError1[ğŸ“ Log Validation Error<br/>Error Type<br/>Field Name] --> Fallback
    ValidateSchema -->|âœ… Valid| ValidateType{âœ… Type Check<br/>Data Types?}

    ValidateType -->|âŒ Invalid| LogError2[ğŸ“ Log Type Error<br/>Expected vs Actual] --> Fallback
    ValidateType -->|âœ… Valid| ValidateRange{âœ… Range Check<br/>Dates, Lengths?}

    ValidateRange -->|âŒ Invalid| LogError3[ğŸ“ Log Range Error<br/>Out of Bounds] --> Fallback
    ValidateRange -->|âœ… Valid| SanitizeHTML[ğŸ§¹ Sanitize HTML<br/>Strip Script Tags<br/>Remove Event Handlers]

    Fallback --> Generate
    SanitizeHTML --> EncodeHTML[ğŸ”’ HTML Entity Encoding<br/>Convert: &lt; &gt; &amp; &quot; &#39;]

    EncodeHTML --> Generate[ğŸ“ Generate Articles<br/>All Languages<br/>All Types]

    Generate --> HTMLValidate[âœ… Validate HTML<br/>htmlhint Rules<br/>Standards Compliance]

    HTMLValidate -->|âŒ Fail| FixHTML[ğŸ”§ Fix HTML Issues<br/>Auto-correct<br/>Report Issues]
    FixHTML --> HTMLValidate

    HTMLValidate -->|âœ… Pass| GenerateIndex[ğŸ“‹ Generate Language Indexes<br/>index-{lang}.html<br/>Sort by Date]

    GenerateIndex --> GenerateSitemap[ğŸ—ºï¸ Generate Sitemap<br/>sitemap.xml<br/>SEO Optimization]

    GenerateSitemap --> RunTests[ğŸ§ª Run Security Tests<br/>ESLint Security<br/>npm audit<br/>Unit Tests]

    RunTests -->|âŒ Fail| TestFail[âŒ Tests Failed<br/>Block Commit<br/>Notify Team]
    RunTests -->|âœ… Pass| CommitChanges[ğŸ“¦ Commit Changes<br/>Git Add<br/>Git Commit<br/>Git Push]

    CommitChanges --> Complete[âœ… Generation Complete<br/>Articles Published<br/>Indexes Updated]
    TestFail --> End[âŒ Workflow Failed]
    Complete --> End[ğŸ‰ Workflow Success]

    style Start fill:#e8f5e9
    style CheckMCP fill:#fff4e1
    style ConnectMCP fill:#e1f5ff
    style Fallback fill:#ffe1e1
    style ValidateSchema fill:#e1f5ff
    style ValidateType fill:#e1f5ff
    style ValidateRange fill:#e1f5ff
    style SanitizeHTML fill:#e8f5e9
    style EncodeHTML fill:#e8f5e9
    style Generate fill:#e8f5e9
    style HTMLValidate fill:#e1f5ff
    style CommitChanges fill:#e8f5e9
    style Complete fill:#d4edda
    style End fill:#d4edda
    style TestFail fill:#ffe1e1
```

---

## ğŸ” Input Validation Security Flow

```mermaid
flowchart TD
    Input[ğŸ“¥ External Input<br/>European Parliament API<br/>Untrusted Data] --> Layer1{ğŸ›¡ï¸ Layer 1<br/>Schema Validation}

    Layer1 -->|âŒ Invalid Structure| Reject1[âŒ Reject Input<br/>Log: Invalid JSON<br/>Use Fallback]
    Layer1 -->|âœ… Valid Structure| Layer2{ğŸ›¡ï¸ Layer 2<br/>Type Validation}

    Layer2 -->|âŒ Wrong Types| Reject2[âŒ Reject Input<br/>Log: Type Mismatch<br/>Use Fallback]
    Layer2 -->|âœ… Correct Types| Layer3{ğŸ›¡ï¸ Layer 3<br/>Range Validation}

    Layer3 -->|âŒ Out of Bounds| Reject3[âŒ Reject Input<br/>Log: Range Error<br/>Use Fallback]
    Layer3 -->|âœ… Within Bounds| Layer4{ğŸ›¡ï¸ Layer 4<br/>Content Sanitization}

    Layer4 --> StripScript[ğŸ§¹ Strip Script Tags<br/>Remove: &lt;script&gt;<br/>Remove: &lt;iframe&gt;<br/>Remove: &lt;object&gt;]
    StripScript --> RemoveEvents[ğŸ§¹ Remove Event Handlers<br/>Remove: onclick<br/>Remove: onerror<br/>Remove: onload]
    RemoveEvents --> ValidateURLs[ğŸ” Validate URLs<br/>Check Protocol<br/>Sanitize Path]

    ValidateURLs --> Layer5{ğŸ›¡ï¸ Layer 5<br/>HTML Encoding}

    Layer5 --> EncodeSpecial[ğŸ”’ Encode Special Chars<br/>&lt; â†’ &amp;lt;<br/>&gt; â†’ &amp;gt;<br/>&amp; â†’ &amp;amp;<br/>&quot; â†’ &amp;quot;<br/>&#39; â†’ &amp;#39;]

    EncodeSpecial --> Layer6{ğŸ›¡ï¸ Layer 6<br/>CSP Compliance}

    Layer6 --> CheckCSP[âœ… Check CSP Headers<br/>No Inline Scripts<br/>No Eval()<br/>No External Scripts]

    CheckCSP -->|âŒ Violation| Reject4[âŒ Block Content<br/>Log: CSP Violation<br/>Return Error]
    CheckCSP -->|âœ… Compliant| SafeOutput[âœ… Safe Output<br/>Validated<br/>Sanitized<br/>Encoded]

    Reject1 --> FallbackContent[âš ï¸ Fallback Content<br/>Placeholder Articles<br/>Safe Default]
    Reject2 --> FallbackContent
    Reject3 --> FallbackContent
    Reject4 --> FallbackContent

    SafeOutput --> DeliverContent[ğŸ“¤ Deliver to Template<br/>Generate HTML<br/>Serve to Users]
    FallbackContent --> DeliverContent

    style Input fill:#fff4e1
    style Layer1 fill:#e1f5ff
    style Layer2 fill:#e1f5ff
    style Layer3 fill:#e1f5ff
    style Layer4 fill:#e8f5e9
    style Layer5 fill:#e8f5e9
    style Layer6 fill:#e8f5e9
    style Reject1 fill:#ffe1e1
    style Reject2 fill:#ffe1e1
    style Reject3 fill:#ffe1e1
    style Reject4 fill:#ffe1e1
    style SafeOutput fill:#d4edda
    style FallbackContent fill:#fff3cd
    style DeliverContent fill:#d4edda
```

---

## ğŸ¤– CI/CD Security Pipeline

```mermaid
flowchart TD
    Trigger[ğŸ”” Git Event<br/>Push to PR<br/>Merge to Main] --> Checkout[ğŸ“¥ Checkout Code<br/>SHA-Pinned Action<br/>actions/checkout@v4]

    Checkout --> SetupNode[âš™ï¸ Setup Node.js 24<br/>SHA-Pinned Action<br/>actions/setup-node@v6]

    SetupNode --> InstallDeps[ğŸ“¦ Install Dependencies<br/>npm ci<br/>Reproducible Build<br/>package-lock.json]

    InstallDeps --> SecurityAudit{ğŸ” npm audit<br/>Vulnerabilities?}

    SecurityAudit -->|âŒ Moderate+| AuditFail[âŒ Security Audit Failed<br/>Block PR Merge<br/>Create Issue]
    SecurityAudit -->|âœ… None/Low| Lint[ğŸ” ESLint<br/>Security Rules<br/>Code Quality<br/>Complexity Check]

    Lint -->|âŒ Errors| LintFail[âŒ Lint Failed<br/>Block PR Merge<br/>Show Errors]
    Lint -->|âœ… Pass| Format[âœ¨ Prettier Check<br/>Code Formatting<br/>Consistency]

    Format -->|âŒ Not Formatted| FormatFail[âŒ Format Failed<br/>Run: npm run format<br/>Commit Changes]
    Format -->|âœ… Formatted| HTMLHint[ğŸ“„ HTMLHint<br/>HTML Validation<br/>Standards Compliance]

    HTMLHint -->|âŒ Errors| HTMLFail[âŒ HTML Failed<br/>Fix Issues<br/>Re-validate]
    HTMLHint -->|âœ… Pass| UnitTests[ğŸ§ª Unit Tests<br/>87 Tests<br/>Vitest]

    UnitTests -->|âŒ Fail| TestFail[âŒ Tests Failed<br/>Block PR Merge<br/>Debug Failures]
    UnitTests -->|âœ… Pass| IntegrationTests[ğŸ”— Integration Tests<br/>82 Tests<br/>MCP Client Tests]

    IntegrationTests -->|âŒ Fail| TestFail
    IntegrationTests -->|âœ… Pass| Coverage{ğŸ“Š Code Coverage<br/>&gt; 80% Lines?<br/>&gt; 75% Branches?}

    Coverage -->|âŒ Below Threshold| CoverageFail[âŒ Coverage Failed<br/>Add Tests<br/>Meet Threshold]
    Coverage -->|âœ… Above Threshold| CodeQL[ğŸ”’ CodeQL SAST<br/>Security Analysis<br/>Vulnerability Detection]

    CodeQL -->|âŒ Findings| CodeQLFail[âŒ CodeQL Failed<br/>Critical/High Issues<br/>Fix Vulnerabilities]
    CodeQL -->|âœ… Clean| BuildCheck[ğŸ—ï¸ Build Check<br/>News Generation<br/>Index Generation<br/>Sitemap Generation]

    BuildCheck -->|âŒ Fail| BuildFail[âŒ Build Failed<br/>Check Logs<br/>Fix Errors]
    BuildCheck -->|âœ… Pass| Approve[âœ… All Checks Passed<br/>Ready to Merge<br/>Deploy on Merge]

    AuditFail --> End[âŒ Pipeline Failed]
    LintFail --> End
    FormatFail --> End
    HTMLFail --> End
    TestFail --> End
    CoverageFail --> End
    CodeQLFail --> End
    BuildFail --> End
    Approve --> End[âœ… Pipeline Success]

    style Trigger fill:#e8f5e9
    style SecurityAudit fill:#ffe1e1
    style Lint fill:#e1f5ff
    style Format fill:#e1f5ff
    style HTMLHint fill:#e1f5ff
    style UnitTests fill:#e8f5e9
    style IntegrationTests fill:#e8f5e9
    style Coverage fill:#e1f5ff
    style CodeQL fill:#ffe1e1
    style BuildCheck fill:#e8f5e9
    style Approve fill:#d4edda
    style End fill:#d4edda
    style AuditFail fill:#ffe1e1
    style LintFail fill:#ffe1e1
    style TestFail fill:#ffe1e1
    style CodeQLFail fill:#ffe1e1
```

---

## ğŸ” MCP Client Connection Security Flow

```mermaid
flowchart TD
    Start[ğŸš€ Initialize MCP Client<br/>Connection Parameters<br/>Retry Config] --> CheckEnv{ğŸ” Check Environment<br/>USE_EP_MCP?}

    CheckEnv -->|âŒ Disabled| DisabledMode[âš ï¸ MCP Disabled<br/>Skip Connection<br/>Use Fallback]
    CheckEnv -->|âœ… Enabled| AttemptCount{ğŸ”„ Attempt Count<br/>< Max Attempts?}

    AttemptCount -->|âŒ Exceeded| MaxRetries[âŒ Max Retries Reached<br/>Log Error<br/>Use Fallback]
    AttemptCount -->|âœ… Within Limit| SpawnProcess[âš™ï¸ Spawn MCP Process<br/>Node.js Child Process<br/>stdio: pipe]

    SpawnProcess --> WaitConnection[â³ Wait for Ready<br/>Timeout: 10s<br/>Monitor stderr]

    WaitConnection --> ConnectionCheck{âœ… Connection<br/>Established?}

    ConnectionCheck -->|âŒ Timeout| IncrementRetry[ğŸ”„ Increment Counter<br/>Calculate Backoff<br/>2^n seconds]
    IncrementRetry --> BackoffWait[â³ Exponential Backoff<br/>1s â†’ 2s â†’ 4s]
    BackoffWait --> AttemptCount

    ConnectionCheck -->|âŒ Process Error| ProcessError[âŒ Process Failed<br/>Log stderr<br/>Kill Process]
    ProcessError --> IncrementRetry

    ConnectionCheck -->|âœ… Connected| SendHandshake[ğŸ¤ Send Handshake<br/>JSON-RPC 2.0<br/>Protocol Version]

    SendHandshake --> HandshakeCheck{âœ… Handshake<br/>Valid?}

    HandshakeCheck -->|âŒ Invalid| HandshakeFail[âŒ Handshake Failed<br/>Protocol Mismatch<br/>Close Connection]
    HandshakeFail --> IncrementRetry

    HandshakeCheck -->|âœ… Valid| Authenticated[âœ… Connection Ready<br/>Reset Retry Counter<br/>Log Success]

    Authenticated --> RequestLoop[ğŸ” Request Loop<br/>Send Requests<br/>Receive Responses]

    RequestLoop --> ValidateResponse{âœ… Validate<br/>Response?}

    ValidateResponse -->|âŒ Invalid| ResponseError[âŒ Invalid Response<br/>Log Error<br/>Retry Request]
    ResponseError --> RetryRequest{Retry < 3?}
    RetryRequest -->|âœ… Yes| RequestLoop
    RetryRequest -->|âŒ No| UseCached[âš ï¸ Use Cached Data<br/>Or Fallback]

    ValidateResponse -->|âœ… Valid| ProcessData[âœ… Process Data<br/>Parse Response<br/>Extract Fields]

    DisabledMode --> End[ğŸ¯ Complete]
    MaxRetries --> End
    UseCached --> End
    ProcessData --> End

    style Start fill:#e8f5e9
    style CheckEnv fill:#fff4e1
    style AttemptCount fill:#e1f5ff
    style SpawnProcess fill:#e8f5e9
    style ConnectionCheck fill:#e1f5ff
    style HandshakeCheck fill:#e1f5ff
    style ValidateResponse fill:#e1f5ff
    style Authenticated fill:#d4edda
    style ProcessData fill:#d4edda
    style DisabledMode fill:#fff3cd
    style MaxRetries fill:#ffe1e1
    style ProcessError fill:#ffe1e1
    style HandshakeFail fill:#ffe1e1
    style ResponseError fill:#ffe1e1
    style End fill:#d4edda
```

---

## ğŸ“Š Content Delivery Security Flow

```mermaid
flowchart LR
    subgraph "User Browser"
        User[ğŸ‘¤ User<br/>Browser Request]
    end

    subgraph "GitHub Pages"
        CDN[ğŸŒ GitHub CDN<br/>TLS 1.3<br/>HTTPS Only]
        CACHE[ğŸ’¾ Edge Cache<br/>Static Content<br/>Immutable]
    end

    subgraph "Security Headers"
        HSTS[ğŸ”’ HSTS<br/>max-age=31536000<br/>Force HTTPS]
        CSP[ğŸ›¡ï¸ CSP<br/>default-src 'self'<br/>No Inline Scripts]
        XCTO[ğŸ” X-Content-Type-Options<br/>nosniff]
        XFO[ğŸš« X-Frame-Options<br/>DENY]
    end

    subgraph "Static Content"
        HTML[ğŸ“„ HTML<br/>Validated<br/>Sanitized]
        CSS[ğŸ¨ CSS<br/>Inline Styles<br/>No External]
    end

    subgraph "Monitoring"
        LOGS[ğŸ“ Access Logs<br/>GitHub Analytics]
        METRICS[ğŸ“Š Metrics<br/>Requests<br/>Response Time]
    end

    User -->|HTTPS Request| CDN
    CDN -->|Check Cache| CACHE
    CACHE -->|Hit| Return
    CACHE -->|Miss| Fetch
    Fetch[Fetch from Origin] --> HTML
    HTML --> CSS
    CSS --> Apply_Headers

    Apply_Headers[Apply Security Headers] --> HSTS
    Apply_Headers --> CSP
    Apply_Headers --> XCTO
    Apply_Headers --> XFO

    HSTS --> Return[Return to User]
    CSP --> Return
    XCTO --> Return
    XFO --> Return

    CDN --> LOGS
    Return --> METRICS
    Return --> User

    style User fill:#e1f5ff
    style CDN fill:#f0f0f0
    style CACHE fill:#e8f5e9
    style HSTS fill:#ffe1e1
    style CSP fill:#ffe1e1
    style XCTO fill:#ffe1e1
    style XFO fill:#ffe1e1
    style HTML fill:#e8f5e9
    style CSS fill:#e8f5e9
    style Return fill:#d4edda
```

---

## ğŸš¨ Incident Response Flow

```mermaid
flowchart TD
    Detection[ğŸ”” Incident Detection<br/>Security Alert<br/>Dependabot<br/>CodeQL<br/>User Report] --> Classify{ğŸ“Š Classify Severity<br/>CVSS Score<br/>Impact Assessment}

    Classify -->|P0 Critical| Critical[ğŸš¨ P0: Critical<br/>Repository Compromise<br/>Malicious Content]
    Classify -->|P1 High| High[âš ï¸ P1: High<br/>XSS Vulnerability<br/>Dependency Issue]
    Classify -->|P2 Medium| Medium[â„¹ï¸ P2: Medium<br/>Data Integrity<br/>Workflow Failure]
    Classify -->|P3 Low| Low[ğŸ“ P3: Low<br/>Documentation<br/>Non-Critical Bug]

    Critical --> ImmediateResponse[âš¡ Immediate Response<br/>Disable Workflows<br/>Revert Commits<br/>Notify Team]
    High --> UrgentResponse[ğŸ”¥ Urgent Response<br/>Create Security Advisory<br/>Block PR Merges]
    Medium --> StandardResponse[ğŸ“‹ Standard Response<br/>Create Issue<br/>Schedule Fix]
    Low --> RoutineResponse[ğŸ“Œ Routine Response<br/>Add to Backlog<br/>Next Sprint]

    ImmediateResponse --> Contain[ğŸ”’ Containment<br/>Remove Malicious Content<br/>Isolate Compromised Code<br/>Revoke Tokens]
    UrgentResponse --> Contain
    StandardResponse --> Contain
    RoutineResponse --> Contain

    Contain --> Investigate[ğŸ” Investigation<br/>Review Git Logs<br/>Check Actions Logs<br/>Analyze CodeQL Findings]

    Investigate --> RootCause{ğŸ¯ Root Cause<br/>Identified?}

    RootCause -->|âŒ No| DeepDive[ğŸ”¬ Deep Analysis<br/>Forensics<br/>External Review]
    DeepDive --> RootCause

    RootCause -->|âœ… Yes| Remediate[ğŸ”§ Remediation<br/>Apply Patches<br/>Update Dependencies<br/>Fix Vulnerabilities]

    Remediate --> Test[ğŸ§ª Testing<br/>Unit Tests<br/>Integration Tests<br/>Security Scans]

    Test -->|âŒ Fail| FixIssues[ğŸ› ï¸ Fix Issues<br/>Debug<br/>Re-apply Fixes]
    FixIssues --> Remediate

    Test -->|âœ… Pass| Deploy[ğŸš€ Deploy Fix<br/>Merge PR<br/>GitHub Actions<br/>Update Documentation]

    Deploy --> Verify[âœ… Verification<br/>Monitor Metrics<br/>Check Logs<br/>Confirm Resolution]

    Verify -->|âŒ Not Resolved| Escalate[â¬†ï¸ Escalate<br/>Senior Review<br/>External Help]
    Escalate --> Investigate

    Verify -->|âœ… Resolved| Document[ğŸ“ Documentation<br/>Incident Report<br/>Lessons Learned<br/>Update Threat Model]

    Document --> Communicate[ğŸ“¢ Communication<br/>Security Advisory<br/>CHANGELOG.md<br/>Close Issue]

    Communicate --> PostMortem[ğŸ”„ Post-Mortem<br/>Team Review<br/>Process Improvements<br/>Update Procedures]

    PostMortem --> Complete[âœ… Incident Closed<br/>Controls Updated<br/>Metrics Recorded]

    style Detection fill:#fff4e1
    style Critical fill:#ffe1e1
    style High fill:#fff3cd
    style Medium fill:#e1f5ff
    style Low fill:#f0f0f0
    style Contain fill:#e8f5e9
    style Remediate fill:#e8f5e9
    style Deploy fill:#e8f5e9
    style Complete fill:#d4edda
```

---

## ğŸ›¡ï¸ Vulnerability Management Workflow

This workflow implements ISO 27001:2022 Control A.8.8 (Management of Technical Vulnerabilities) with defined severity levels and SLA-based remediation timelines.

```mermaid
flowchart TD
    Discovery[ğŸ” Vulnerability Discovery] --> Source{Discovery<br/>Source}
    
    Source -->|Dependabot| DepAlert[ğŸ¤– Dependabot Alert<br/>Dependencies<br/>GitHub Security]
    Source -->|CodeQL| CodeQLAlert[ğŸ”’ CodeQL Finding<br/>SAST Scanning<br/>Security Issue]
    Source -->|npm audit| AuditAlert[ğŸ“¦ npm audit<br/>Package Vulnerabilities<br/>CVE Database]
    Source -->|Manual| ManualReport[ğŸ‘¤ Manual Report<br/>Security Researcher<br/>User Report]
    
    DepAlert --> Assess
    CodeQLAlert --> Assess
    AuditAlert --> Assess
    ManualReport --> Assess
    
    Assess[ğŸ“Š Assessment Phase] --> CVSSScore{ğŸ¯ CVSS Score<br/>Calculation}
    
    CVSSScore --> Exploit{ğŸ”¬ Exploitability<br/>Analysis}
    Exploit --> Impact{ğŸ’¥ Impact<br/>Assessment}
    
    Impact --> Prioritize{âš¡ Prioritization}
    
    Prioritize -->|Critical 9.0-10.0| Critical[ğŸš¨ P0: Critical<br/>SLA: 24 hours<br/>Remote Code Execution<br/>Data Breach Risk]
    Prioritize -->|High 7.0-8.9| High[âš ï¸ P1: High<br/>SLA: 7 days<br/>Privilege Escalation<br/>XSS/CSRF]
    Prioritize -->|Medium 4.0-6.9| Medium[â„¹ï¸ P2: Medium<br/>SLA: 30 days<br/>Information Disclosure<br/>DoS]
    Prioritize -->|Low 0.1-3.9| Low[ğŸ“ P3: Low<br/>SLA: 90 days<br/>Minor Issues<br/>Low Impact]
    
    Critical --> EmergencyTeam[ğŸš¨ Emergency Response<br/>Notify Security Team<br/>Disable Affected Feature]
    High --> UrgentAction[ğŸ”¥ Urgent Action<br/>Create Security Advisory<br/>Block Deployments]
    Medium --> StandardTrack[ğŸ“‹ Standard Track<br/>Create Issue<br/>Schedule Sprint]
    Low --> BacklogAdd[ğŸ“Œ Backlog<br/>Log for Future<br/>Next Release]
    
    EmergencyTeam --> Remediation
    UrgentAction --> Remediation
    StandardTrack --> Remediation
    BacklogAdd --> Remediation
    
    Remediation[ğŸ”§ Remediation Strategy] --> Strategy{Strategy<br/>Selection}
    
    Strategy -->|Available| Patch[ğŸ©¹ Apply Patch<br/>Update Dependency<br/>Upgrade Version]
    Strategy -->|Not Available| Workaround[ğŸ”€ Implement Workaround<br/>Code Changes<br/>Configuration Update]
    Strategy -->|Not Feasible| Mitigate[ğŸ›¡ï¸ Mitigate Risk<br/>Additional Controls<br/>Monitoring]
    Strategy -->|False Positive| Accept[âœ… Accept Risk<br/>Document Rationale<br/>Security Exception]
    
    Patch --> Testing
    Workaround --> Testing
    Mitigate --> Testing
    Accept --> Document
    
    Testing[ğŸ§ª Verification Testing] --> UnitTest[âœ… Unit Tests<br/>169 Tests Pass]
    UnitTest --> IntegTest[ğŸ”— Integration Tests<br/>82 Tests Pass]
    IntegTest --> SecScan[ğŸ”’ Security Scan<br/>CodeQL Clean<br/>npm audit Clean]
    
    SecScan --> TestResult{Tests<br/>Pass?}
    TestResult -->|âŒ Fail| FixFailed[ğŸ› ï¸ Fix Failed Tests<br/>Debug Issues<br/>Adjust Fix]
    FixFailed --> Remediation
    
    TestResult -->|âœ… Pass| Deploy[ğŸš€ Deploy Fix<br/>Merge PR<br/>Production Release]
    
    Deploy --> Verify[âœ… Post-Deploy Verification] --> Rescan{Vulnerability<br/>Resolved?}
    
    Rescan -->|âŒ Not Fixed| Escalate[â¬†ï¸ Escalate<br/>Senior Security Review<br/>External Consultation]
    Escalate --> Remediation
    
    Rescan -->|âœ… Fixed| Document[ğŸ“ Documentation]
    
    Document --> UpdateAdvisory[ğŸ“„ Update Security Advisory<br/>CVE Details<br/>Remediation Steps]
    UpdateAdvisory --> UpdateCHANGELOG[ğŸ“‹ Update CHANGELOG.md<br/>Security Fix Entry<br/>Version Bump]
    UpdateCHANGELOG --> CloseIssue[ğŸ”’ Close Issue<br/>Link to Commit<br/>Verification Evidence]
    
    CloseIssue --> Metrics[ğŸ“Š Update Metrics<br/>MTTR Calculation<br/>Vulnerability Stats]
    
    Metrics --> Review[ğŸ”„ Post-Fix Review<br/>Lessons Learned<br/>Process Improvement]
    
    Review --> Complete[âœ… Vulnerability Closed<br/>Evidence Recorded<br/>Controls Updated]
    
    style Discovery fill:#fff4e1
    style Critical fill:#ffe1e1
    style High fill:#fff3cd
    style Medium fill:#e1f5ff
    style Low fill:#f0f0f0
    style Patch fill:#e8f5e9
    style Testing fill:#e1f5ff
    style Deploy fill:#e8f5e9
    style Complete fill:#d4edda
    style Accept fill:#fff3cd
```

### Vulnerability Management Security Controls

| Phase | Control | SLA | ISMS Reference |
|-------|---------|-----|----------------|
| **Discovery** | Automated scanning (Dependabot, CodeQL, npm audit) | Continuous | ISO 27001 A.8.8 |
| **Assessment** | CVSS scoring, exploitability analysis | 24 hours | NIST SP 800-30 |
| **Prioritization** | Risk-based tiers with SLAs | By severity | ISO 27001 A.5.9 |
| **Remediation** | Patch/workaround/mitigate/accept | 24h-90d | ISO 27001 A.8.8 |
| **Verification** | Testing, scanning, deployment validation | Before close | ISO/IEC 27001:2013 A.14.2.8 |
| **Documentation** | Advisories, CHANGELOG, evidence | Required | ISO/IEC 27001:2013 A.12.1.1 |
| **Metrics** | MTTR, vulnerability stats tracking | Monthly | ISO/IEC 27001:2013 A.18.2.1 |

**Mean Time to Remediate (MTTR) Targets:**
- Critical (P0): 24 hours
- High (P1): 7 days
- Medium (P2): 30 days
- Low (P3): 90 days

---

## ğŸ”— MCP Data Integration Security Flow

This flow shows the end-to-end secure data pipeline from European Parliament APIs through the MCP server to static site generation, with comprehensive security controls at each stage.

```mermaid
flowchart TD
    subgraph "European Parliament APIs"
        EPAPI[ğŸ›ï¸ EP Official APIs<br/>MEPs, Sessions<br/>Documents, Votes]
    end
    
    subgraph "MCP Server Layer"
        MCPServer[âš™ï¸ EP MCP Server<br/>TypeScript 5.7<br/>Node.js 24]
        MCPTransport[ğŸ“¡ JSON-RPC 2.0<br/>stdio Transport<br/>Protocol v1.0]
        MCPCache[ğŸ’¾ LRU Cache<br/>TTL: 5 min<br/>Max: 500 entries]
    end
    
    subgraph "Client Layer"
        MCPClient[ğŸ”Œ MCP Client<br/>Custom JSON-RPC over stdio<br/>src/mcp/ep-mcp-client.ts<br/>Planned: @modelcontextprotocol/sdk]
        SchemaVal[ğŸ§ª Planned: Schema Validation<br/>JSON Schema<br/>Type Checking]
        TypeCheck[ğŸ” Planned: Type Validation<br/>TypeScript Interfaces<br/>Runtime Checks]
    end
    
    subgraph "Sanitization Pipeline"
        HTMLSan[ğŸ§¹ Planned: HTML Sanitizer<br/>DOMPurify<br/>Strip Scripts]
        XSSEncode[ğŸ”’ Planned: XSS Encoding<br/>HTML Entities<br/>&lt; &gt; &amp; &quot; &#39;]
        URLVal[ğŸ”— Planned: URL Validation<br/>HTTPS Only<br/>Domain Whitelist]
        LengthCheck[ğŸ“ Planned: Length Validation<br/>Max Lengths<br/>Truncation]
    end
    
    subgraph "Content Generation"
        Template[ğŸ“„ Template Engine<br/>14 Languages<br/>HTML5]
        CSPCheck[ğŸ›¡ï¸ CSP Compliance<br/>JSON-LD Allowed<br/>No eval()]
        HTMLVal[âœ… HTML Validation<br/>htmlhint<br/>Standards Check]
    end
    
    subgraph "Output Layer"
        StaticFiles[ğŸ“¦ Static HTML<br/>index-{lang}.html<br/>CSS Inline]
        Sitemap[ğŸ—ºï¸ Sitemap.xml<br/>SEO Optimized<br/>14 Languages]
        Deploy[ğŸš€ AWS S3 + CloudFront<br/>Primary: S3 Sync Deploy<br/>CDN: CloudFront Invalidation]
    end
    
    subgraph "Error Handling"
        FallbackData[âš ï¸ Fallback Content<br/>Placeholder Articles<br/>Safe Defaults]
        ErrorLog[ğŸ“ Error Logging<br/>Structured Logs<br/>GitHub Actions]
    end
    
    EPAPI -->|HTTPS Request| MCPServer
    MCPServer --> MCPTransport
    MCPTransport --> MCPCache
    
    MCPCache -->|Cache Hit| ReturnCached[âœ… Return Cached<br/>Skip API Call]
    MCPCache -->|Cache Miss| FetchFresh[ğŸ“¥ Fetch Fresh<br/>Call EP API]
    
    ReturnCached --> MCPClient
    FetchFresh --> MCPClient
    
    MCPClient --> SchemaVal
    SchemaVal -->|âŒ Invalid| ErrorLog
    SchemaVal -->|âœ… Valid| TypeCheck
    
    TypeCheck -->|âŒ Invalid| ErrorLog
    TypeCheck -->|âœ… Valid| HTMLSan
    
    ErrorLog --> FallbackData
    FallbackData --> Template
    
    HTMLSan --> XSSEncode
    XSSEncode --> URLVal
    URLVal --> LengthCheck
    
    LengthCheck --> Template
    
    Template --> CSPCheck
    CSPCheck -->|âŒ Violation| ErrorLog
    CSPCheck -->|âœ… Compliant| HTMLVal
    
    HTMLVal -->|âŒ Invalid| FixHTML[ğŸ”§ Auto-Fix HTML<br/>Correct Issues]
    FixHTML --> HTMLVal
    HTMLVal -->|âœ… Valid| StaticFiles
    
    StaticFiles --> Sitemap
    Sitemap --> Deploy
    
    Deploy --> CDN[ğŸŒ GitHub CDN<br/>Edge Caching<br/>Global Distribution]
    
    style EPAPI fill:#e3f2fd
    style MCPServer fill:#f0f4c3
    style MCPClient fill:#c8e6c9
    style HTMLSan fill:#fff9c4
    style XSSEncode fill:#ffe1e1
    style Template fill:#e1f5ff
    style StaticFiles fill:#e8f5e9
    style Deploy fill:#c8e6c9
    style FallbackData fill:#fff3cd
    style ErrorLog fill:#ffcdd2
    style CDN fill:#d4edda
```

### Data Integration Security Controls

| Layer | Control | Purpose | Implementation |
|-------|---------|---------|----------------|
| **API Layer** | HTTPS-only communication | Encryption in transit | TLS 1.3, HTTPS-only, HSTS via CDN/hosting config |
| **MCP Server** | JSON-RPC 2.0 protocol | Structured communication | Standard protocol implementation |
| **Caching** | LRU cache with TTL | Performance + resilience | 5 min TTL, 500 entry max |
| **Schema Validation** | JSON Schema enforcement (future control) | Data structure integrity | Planned: Ajv validator (strict mode), not yet implemented in codebase |
| **Type Checking** | Runtime type validation (future control) | Type safety beyond TypeScript | Planned: io-ts runtime checks, not yet implemented in codebase |
| **HTML Sanitization** | Planned: DOMPurify scrubbing (future control) | XSS prevention | Not yet in codebase; current: HTML entity encoding via template |
| **XSS Encoding** | HTML entity encoding (future control) | Output encoding | Planned: template-level encoding for all user-controlled data, not yet implemented in codebase |
| **URL Validation** | HTTPS + whitelist (future control) | Prevent malicious redirects | Planned: HTTPS-only + europarl.europa.eu allowlist for article/source URLs, not yet implemented in codebase |
| **CSP Enforcement** | JSON-LD inline scripts allowed; no eval() | XSS mitigation | default-src 'self'; script-src allows type=application/ld+json |
| **HTML Validation** | Standards compliance | Cross-browser compatibility | htmlhint, W3C validation |
| **Fallback Content** | Graceful degradation | Availability | Placeholder articles |
| **Error Logging** | Structured logging | Debugging + monitoring | GitHub Actions logs |

---

## ğŸŒ Multi-Language Content Generation Workflow

This workflow illustrates the full CI/CD content generation and validation pipeline for European Parliament news in 14 languages (PR/test-and-report.yml and release.yml). The scheduled daily `.github/workflows/news-generation.yml` job only runs the generate-and-commit subset (no HTML/SEO/a11y validation loop).

```mermaid
flowchart TD
    Start[ğŸš€ Content Generation<br/>CI/CD: PRs / Releases<br/>Daily 06:00 UTC (subset)] --> FetchData[ğŸ“¥ Fetch Source Data<br/>EP MCP Server<br/>Validated JSON]
    
    FetchData --> LangDetect{âš™ï¸ Language Args &<br/>Preset Expansion}
    
    LangDetect --> EN[ğŸ‡¬ğŸ‡§ English<br/>index.html]
    LangDetect --> SV[ğŸ‡¸ğŸ‡ª Swedish<br/>index-sv.html]
    LangDetect --> DA[ğŸ‡©ğŸ‡° Danish<br/>index-da.html]
    LangDetect --> NO[ğŸ‡³ğŸ‡´ Norwegian<br/>index-no.html]
    LangDetect --> FI[ğŸ‡«ğŸ‡® Finnish<br/>index-fi.html]
    LangDetect --> DE[ğŸ‡©ğŸ‡ª German<br/>index-de.html]
    LangDetect --> FR[ğŸ‡«ğŸ‡· French<br/>index-fr.html]
    LangDetect --> ES[ğŸ‡ªğŸ‡¸ Spanish<br/>index-es.html]
    LangDetect --> NL[ğŸ‡³ğŸ‡± Dutch<br/>index-nl.html]
    LangDetect --> AR[ğŸ‡¸ğŸ‡¦ Arabic<br/>index-ar.html]
    LangDetect --> HE[ğŸ‡®ğŸ‡± Hebrew<br/>index-he.html]
    LangDetect --> JA[ğŸ‡¯ğŸ‡µ Japanese<br/>index-ja.html]
    LangDetect --> KO[ğŸ‡°ğŸ‡· Korean<br/>index-ko.html]
    LangDetect --> ZH[ğŸ‡¨ğŸ‡³ Chinese<br/>index-zh.html]
    
    EN --> ENTemplate[ğŸ“„ EN Template<br/>HTML5 Structure<br/>Semantic Tags]
    SV --> SVTemplate[ğŸ“„ SV Template<br/>HTML5 Structure<br/>Semantic Tags]
    DA --> DATemplate[ğŸ“„ DA Template<br/>HTML5 Structure<br/>Semantic Tags]
    NO --> NOTemplate[ğŸ“„ NO Template<br/>HTML5 Structure<br/>Semantic Tags]
    FI --> FITemplate[ğŸ“„ FI Template<br/>HTML5 Structure<br/>Semantic Tags]
    DE --> DETemplate[ğŸ“„ DE Template<br/>HTML5 Structure<br/>Semantic Tags]
    FR --> FRTemplate[ğŸ“„ FR Template<br/>HTML5 Structure<br/>Semantic Tags]
    ES --> ESTemplate[ğŸ“„ ES Template<br/>HTML5 Structure<br/>Semantic Tags]
    NL --> NLTemplate[ğŸ“„ NL Template<br/>HTML5 Structure<br/>Semantic Tags]
    AR --> ARTemplate[ğŸ“„ AR Template<br/>HTML5 Structure<br/>RTL Support]
    HE --> HETemplate[ğŸ“„ HE Template<br/>HTML5 Structure<br/>RTL Support]
    JA --> JATemplate[ğŸ“„ JA Template<br/>HTML5 Structure<br/>Semantic Tags]
    KO --> KOTemplate[ğŸ“„ KO Template<br/>HTML5 Structure<br/>Semantic Tags]
    ZH --> ZHTemplate[ğŸ“„ ZH Template<br/>HTML5 Structure<br/>Semantic Tags]
    
    ENTemplate --> ENSecCheck[ğŸ”’ EN Security<br/>Sanitize + Validate]
    SVTemplate --> SVSecCheck[ğŸ”’ SV Security<br/>Sanitize + Validate]
    DATemplate --> DASecCheck[ğŸ”’ DA Security<br/>Sanitize + Validate]
    NOTemplate --> NOSecCheck[ğŸ”’ NO Security<br/>Sanitize + Validate]
    FITemplate --> FISecCheck[ğŸ”’ FI Security<br/>Sanitize + Validate]
    DETemplate --> DESecCheck[ğŸ”’ DE Security<br/>Sanitize + Validate]
    FRTemplate --> FRSecCheck[ğŸ”’ FR Security<br/>Sanitize + Validate]
    ESTemplate --> ESSecCheck[ğŸ”’ ES Security<br/>Sanitize + Validate]
    NLTemplate --> NLSecCheck[ğŸ”’ NL Security<br/>Sanitize + Validate]
    ARTemplate --> ARSecCheck[ğŸ”’ AR Security<br/>Sanitize + Validate]
    HETemplate --> HESecCheck[ğŸ”’ HE Security<br/>Sanitize + Validate]
    JATemplate --> JASecCheck[ğŸ”’ JA Security<br/>Sanitize + Validate]
    KOTemplate --> KOSecCheck[ğŸ”’ KO Security<br/>Sanitize + Validate]
    ZHTemplate --> ZHSecCheck[ğŸ”’ ZH Security<br/>Sanitize + Validate]
    
    ENSecCheck --> Aggregate
    SVSecCheck --> Aggregate
    DASecCheck --> Aggregate
    NOSecCheck --> Aggregate
    FISecCheck --> Aggregate
    DESecCheck --> Aggregate
    FRSecCheck --> Aggregate
    ESSecCheck --> Aggregate
    NLSecCheck --> Aggregate
    ARSecCheck --> Aggregate
    HESecCheck --> Aggregate
    JASecCheck --> Aggregate
    KOSecCheck --> Aggregate
    ZHSecCheck --> Aggregate
    
    Aggregate[ğŸ“‹ Aggregate Results<br/>14 Language Indexes<br/>Collect Metadata] --> MainIndex[ğŸ  Generate Main Index<br/>index.html<br/>Language Selector]
    
    MainIndex --> Sitemap[ğŸ—ºï¸ Generate Sitemap<br/>sitemap.xml<br/>All 14 Languages]
    
    Sitemap --> ValidateAll{âœ… Validate<br/>All Files?}
    
    ValidateAll -->|âŒ Validation Errors| ShowErrors[âŒ Show Errors<br/>htmlhint Output<br/>Line Numbers]
    ShowErrors --> FixErrors[ğŸ”§ Auto-Fix<br/>Common Issues<br/>Re-validate]
    FixErrors --> ValidateAll
    
    ValidateAll -->|âœ… All Valid| A11yCheck[â™¿ Accessibility Check<br/>WCAG 2.1 AA<br/>E2E Workflow Only]
    
    A11yCheck -->|âŒ A11y Issues| FixA11y[ğŸ”§ Fix A11y<br/>Add lang Attributes<br/>Alt Text]
    FixA11y --> A11yCheck
    
    A11yCheck -->|âœ… Compliant| SEOCheck[ğŸ“Š SEO Validation<br/>Meta Tags<br/>hreflang Links<br/>Release Workflow Only]
    
    SEOCheck --> Complete[âœ… Generation Complete<br/>14 Languages<br/>Ready to Deploy]
    
    style Start fill:#e3f2fd
    style LangDetect fill:#fff4e1
    style EN fill:#e8f5e9
    style FR fill:#e8f5e9
    style DE fill:#e8f5e9
    style ES fill:#e8f5e9
    style IT fill:#e8f5e9
    style PT fill:#e8f5e9
    style ENSecCheck fill:#ffe1e1
    style FRSecCheck fill:#ffe1e1
    style DESecCheck fill:#ffe1e1
    style ESSecCheck fill:#ffe1e1
    style ITSecCheck fill:#ffe1e1
    style PTSecCheck fill:#ffe1e1
    style Aggregate fill:#e1f5ff
    style MainIndex fill:#c8e6c9
    style Sitemap fill:#c8e6c9
    style Complete fill:#d4edda
```

### Multi-Language Security Controls

| Control | Applied to | Purpose | Standard |
|---------|-----------|---------|----------|
| **HTML Sanitization** | All 14 languages | XSS prevention | OWASP ASVS 5.3 |
| **HTML Entity Encoding** | All 14 languages | Output encoding | OWASP ASVS 5.2 |
| **HTML Validation** | All 14 languages | Standards compliance | W3C HTML5 |
| **Language Attributes** | All 14 languages | Accessibility | WCAG 2.1 AA 3.1.1 |
| **hreflang Links** | All 14 languages | SEO, crawling | Google Guidelines |
| **CSP Headers** | All 14 languages | Script execution control | OWASP CSP |
| **Character Encoding** | All 14 languages | UTF-8 declaration | HTML5 Standard |
| **Text Direction Handling** | All 14 languages (LTR/RTL) | Ensure correct text direction rendering | HTML `dir` attribute / W3C HTML5 |

**Supported Languages:**
1. ğŸ‡¬ğŸ‡§ English (en) - Primary
2. ğŸ‡¸ğŸ‡ª Swedish (sv) - Nordic
3. ğŸ‡©ğŸ‡° Danish (da) - Nordic
4. ğŸ‡³ğŸ‡´ Norwegian (no) - Nordic
5. ğŸ‡«ğŸ‡® Finnish (fi) - Nordic
6. ğŸ‡©ğŸ‡ª German (de) - European
7. ğŸ‡«ğŸ‡· French (fr) - European
8. ğŸ‡ªğŸ‡¸ Spanish (es) - European
9. ğŸ‡³ğŸ‡± Dutch (nl) - European
10. ğŸ‡¸ğŸ‡¦ Arabic (ar) - RTL
11. ğŸ‡®ğŸ‡± Hebrew (he) - RTL
12. ğŸ‡¯ğŸ‡µ Japanese (ja) - East Asian
13. ğŸ‡°ğŸ‡· Korean (ko) - East Asian
14. ğŸ‡¨ğŸ‡³ Chinese (zh) - East Asian

---

## ğŸš€ Deployment Security Flow

This flow shows the secure deployment pipeline from Git commit to S3/CloudFront with comprehensive security gates, SBOM generation, and SLSA attestations. Note: linting, testing, and coverage gates apply to PR merges and release workflows; the daily news-generation workflow triggers S3 deployment directly after build.

```mermaid
flowchart TD
    Commit[ğŸ’¾ Git Commit<br/>Developer Push<br/>Feature Branch] --> SHAVerify[ğŸ” SHA Verification<br/>Git Integrity Check<br/>GPG Signature]
    
    SHAVerify --> GHActions[ğŸ¤– GitHub Actions<br/>Workflow Trigger<br/>ubuntu-latest]
    
    GHActions --> SecGates[ğŸ›¡ï¸ Security Gates<br/>PR & Release Workflows] --> Gate1{Gate 1:<br/>Linting}
    
    Gate1 -->|âŒ Fail| BlockDeploy1[ğŸš« Block PR / Release<br/>ESLint Errors<br/>Fix Required]
    Gate1 -->|âœ… Pass| Gate2{Gate 2:<br/>Unit Tests}
    
    Gate2 -->|âŒ Fail| BlockDeploy2[ğŸš« Block PR / Release<br/>169 Tests Failed<br/>Debug Required]
    Gate2 -->|âœ… Pass| Gate3{Gate 3:<br/>Integration Tests}
    
    Gate3 -->|âŒ Fail| BlockDeploy3[ğŸš« Block PR / Release<br/>82 Tests Failed<br/>Fix Required]
    Gate3 -->|âœ… Pass| Gate4{Gate 4:<br/>Security Scan}
    
    Gate4 -->|âŒ Critical/High| BlockDeploy4[ğŸš« Block PR / Release<br/>CodeQL Issues<br/>Vulnerability Fix]
    Gate4 -->|âœ… Pass| Gate5{Gate 5:<br/>Coverage}
    
    Gate5 -->|âŒ Below 80%| BlockDeploy5[ğŸš« Block PR / Release<br/>Coverage Too Low<br/>Add Tests]
    Gate5 -->|âœ… Pass| Build[ğŸ—ï¸ Build Phase]
    
    Build --> GenNews[ğŸ“° Generate News<br/>14 Languages<br/>All Article Types]
    GenNews --> GenIndex[ğŸ“‹ Generate Indexes<br/>Language Indexes<br/>Main Index]
    GenIndex --> GenSitemap[ğŸ—ºï¸ Generate Sitemap<br/>sitemap.xml<br/>SEO Optimization]
    
    GenSitemap --> SBOM[ğŸ“¦ SBOM Generation<br/>SPDX Format<br/>All Dependencies]
    
    SBOM --> Attest1[ğŸ” Build Provenance<br/>SLSA Level 3<br/>GitHub Attestations]
    Attest1 --> Attest2[ğŸ” SBOM Attestation<br/>Cryptographic Sign<br/>Sigstore]
    
    Attest2 --> Artifacts[ğŸ“¦ Collect Artifacts<br/>HTML Files<br/>CSS Files<br/>Sitemap<br/>SBOM]
    
    Artifacts --> DeployPrep[ğŸš€ Deployment Prep<br/>Organize Files<br/>Check Integrity]
    
    DeployPrep --> DeployS3[ğŸ“¤ Deploy to S3<br/>S3 Bucket<br/>Upload Files]
    
    DeployS3 --> CDNProp[ğŸŒ CDN Propagation<br/>CloudFront CDN<br/>Edge Nodes<br/>Global Distribution]
    
    CDNProp --> HealthCheck{ğŸ¥ Health Check<br/>Site Accessible?}
    
    HealthCheck -->|âŒ Failed| Rollback[ğŸ”™ Rollback<br/>Revert to Previous<br/>Restore Last Good]
    Rollback --> NotifyFailure[ğŸ“§ Notify Team<br/>Deployment Failed<br/>Incident Created]
    
    HealthCheck -->|âœ… Success| Verify[âœ… Verification Phase] --> CheckHTTPS{HTTPS<br/>Working?}
    
    CheckHTTPS -->|âŒ No| Rollback
    CheckHTTPS -->|âœ… Yes| CheckContent{Content<br/>Loads?}
    
    CheckContent -->|âŒ No| Rollback
    CheckContent -->|âœ… Yes| CheckLangs{All 14<br/>Languages?}
    
    CheckLangs -->|âŒ Missing| Rollback
    CheckLangs -->|âœ… Present| CheckSitemap{Sitemap<br/>Valid?}
    
    CheckSitemap -->|âŒ Invalid| Rollback
    CheckSitemap -->|âœ… Valid| UpdateMetrics[ğŸ“Š Update Metrics<br/>Deployment Time<br/>Build Duration<br/>Success Rate]
    
    UpdateMetrics --> TagRelease[ğŸ·ï¸ Tag Release<br/>Git Tag<br/>Version Bump<br/>Create GitHub Release]
    
    TagRelease --> NotifySuccess[ğŸ“§ Notify Team<br/>Deployment Successful<br/>Version + URL]
    
    NotifySuccess --> Complete[âœ… Deployment Complete<br/>Live on S3/CloudFront<br/>Attested + Verified]
    
    style Commit fill:#e3f2fd
    style SHAVerify fill:#ffe1e1
    style Gate1 fill:#e1f5ff
    style Gate2 fill:#e1f5ff
    style Gate3 fill:#e1f5ff
    style Gate4 fill:#ffe1e1
    style Gate5 fill:#e1f5ff
    style BlockDeploy1 fill:#ffcdd2
    style BlockDeploy2 fill:#ffcdd2
    style BlockDeploy3 fill:#ffcdd2
    style BlockDeploy4 fill:#ffcdd2
    style BlockDeploy5 fill:#ffcdd2
    style SBOM fill:#fff9c4
    style Attest1 fill:#ffe1e1
    style Attest2 fill:#ffe1e1
    style DeployS3 fill:#c8e6c9
    style CDNProp fill:#e8f5e9
    style Rollback fill:#ffcdd2
    style Complete fill:#d4edda
```

### Deployment Security Controls

| Stage | Control | Purpose | Implementation |
|-------|---------|---------|----------------|
| **Commit** | SHA verification, GPG signatures | Code integrity | Git built-in |
| **Linting** | ESLint security rules | Code quality, vulnerabilities | eslint-plugin-security |
| **Unit Tests** | 169 tests, 82%+ coverage | Functional correctness | Vitest |
| **Integration Tests** | 82 MCP client tests | API contract validation | Vitest + custom JSON-RPC MCP client |
| **Security Scan** | CodeQL SAST | Vulnerability detection | GitHub CodeQL |
| **Coverage Gate** | 80% lines, 75% branches | Test thoroughness | Vitest v8 provider (@vitest/coverage-v8) |
| **SBOM** | SPDX JSON format | Supply chain transparency | Anchore SBOM Action |
| **Provenance** | SLSA Level 3 | Build integrity | GitHub Attestations |
| **Attestation** | Cryptographic signing | Artifact authenticity | Sigstore |
| **Health Check** | Multi-point verification | Deployment validation | Custom checks |
| **Rollback** | Automated revert | Failure recovery | Git + S3 re-deploy |
| **Metrics** | Deployment tracking | Performance monitoring | GitHub Actions logs |

**Deployment Security Requirements:**
1. âœ… All security gates must pass (no critical/high vulnerabilities)
2. âœ… SBOM generated and attested for every deployment
3. âœ… SLSA Level 3 provenance attestation required
4. âœ… Health checks must pass before declaring success
5. âœ… Automatic rollback on any verification failure
6. âœ… Team notification on success/failure
7. âœ… Deployment metrics recorded for audit trail

---

## ğŸš€ Release Workflow with Documentation Automation

This comprehensive flow shows the automated release process with SLSA Level 3
attestations and documentation-as-code implementation.

```mermaid
flowchart TD
    Start[ğŸš€ Release Trigger<br/>Manual or Tag Push] --> Prepare[ğŸ“‹ Prepare Job]

    Prepare --> Lint[ğŸ” Run Linter<br/>ESLint Validation]
    Lint --> HTMLVal[âœ… Validate HTML<br/>htmlhint]
    HTMLVal --> Coverage[ğŸ“Š Run Tests with Coverage<br/>169 Unit Tests<br/>82%+ Coverage]

    Coverage --> CoverageCheck{Coverage<br/>Thresholds?}
    CoverageCheck -->|âŒ Fail| Fail1[âŒ Build Failed]
    CoverageCheck -->|âœ… Pass| E2E[ğŸ­ Run E2E Tests<br/>Playwright Chromium]

    E2E --> E2ECheck{E2E Tests<br/>Pass?}
    E2ECheck -->|âŒ Fail| Fail2[âŒ Build Failed]
    E2ECheck -->|âœ… Pass| CleanDocs[ğŸ§¹ Clean Old Documentation<br/>Remove docs/api, coverage, test-results]

    CleanDocs --> GenAPI[ğŸ“– Generate API Documentation<br/>JSDoc â†’ docs/api/<br/>52 files]
    GenAPI --> CopyReports[ğŸ“‹ Copy Test Reports<br/>Coverage â†’ docs/coverage/<br/>Test Results â†’ docs/test-results/]

    CopyReports --> GenIndex[ğŸ¨ Generate Documentation Index<br/>Beautiful Hub Page<br/>docs/index.html]

    GenIndex --> VerifyDocs{Verify<br/>Documentation<br/>Structure?}
    VerifyDocs -->|âŒ Missing Files| Fail3[âŒ Build Failed]
    VerifyDocs -->|âœ… Complete| CommitDocs[ğŸ’¾ Commit Documentation<br/>Git Auto-Commit<br/>To Main Branch]

    CommitDocs --> TagVersion{Workflow<br/>Dispatch?}
    TagVersion -->|âœ… Yes| CreateTag[ğŸ·ï¸ Create Version Tag<br/>npm version + git tag]
    TagVersion -->|âŒ No| Build[ğŸ”¨ Build Job]
    CreateTag --> Build

    Build --> Checkout2[ğŸ“¥ Checkout at Tag]
    Checkout2 --> GenNews{News<br/>Directory<br/>Empty?}
    GenNews -->|âœ… Yes| SampleNews[ğŸ“° Generate Sample News<br/>Week Ahead Articles]
    GenNews -->|âŒ No| CreateArtifact
    SampleNews --> CreateArtifact[ğŸ“¦ Create Release Artifacts<br/>Include docs/, playwright-report/<br/>ZIP Archive]

    CreateArtifact --> GenSBOM[ğŸ” Generate SBOM<br/>SPDX JSON Format<br/>Anchore SBOM Action]
    GenSBOM --> BuildProv[ğŸ“œ Build Provenance Attestation<br/>SLSA Level 3<br/>GitHub Attestations API]
    BuildProv --> SBOMAttest[ğŸ” SBOM Attestation<br/>Cryptographic Signing]

    SBOMAttest --> UploadArtifacts[ğŸ“¤ Upload All Artifacts<br/>Build + Security Artifacts]

    UploadArtifacts --> Release[ğŸš€ Release Job]
    Release --> DraftNotes[ğŸ“ Draft Release Notes<br/>Release Drafter]
    DraftNotes --> CreateRelease[ğŸ‰ Create GitHub Release<br/>Attach All Artifacts]

    CreateRelease --> Verify{Verification<br/>Required?}
    Verify -->|âœ… Yes| VerifyCmd[ğŸ” Verify Attestations<br/>gh attestation verify]
    Verify -->|âŒ No| Complete[âœ… Release Complete<br/>Documentation Published<br/>Artifacts Attested]
    VerifyCmd --> Complete

    style Start fill:#e3f2fd
    style Prepare fill:#f0f4c3
    style Lint fill:#e1f5ff
    style Coverage fill:#e1f5ff
    style E2E fill:#e1f5ff
    style CleanDocs fill:#fff9c4
    style GenAPI fill:#c8e6c9
    style CopyReports fill:#c8e6c9
    style GenIndex fill:#c8e6c9
    style CommitDocs fill:#a5d6a7
    style Build fill:#f0f4c3
    style GenSBOM fill:#ffe1e1
    style BuildProv fill:#ffe1e1
    style SBOMAttest fill:#ffe1e1
    style Release fill:#f0f4c3
    style CreateRelease fill:#c5cae9
    style Complete fill:#c8e6c9
    style Fail1 fill:#ffcdd2
    style Fail2 fill:#ffcdd2
    style Fail3 fill:#ffcdd2
```

### Release Workflow Security Controls

| Stage                | Control                       | Purpose                     | ISMS Reference                  |
| -------------------- | ----------------------------- | --------------------------- | ------------------------------- |
| **Validation**       | Linter + HTML validation      | Code quality, syntax errors | Quality standards               |
| **Testing**          | 169 unit tests, 82%+ coverage | Functional correctness      | Â§3.3 Testing Requirements       |
| **E2E Testing**      | Playwright across browsers    | User workflow validation    | Quality assurance               |
| **Documentation**    | JSDoc, coverage, E2E reports  | Evidence generation         | Â§3.2 Architecture Documentation |
| **Version Control**  | Git commit + tag              | Audit trail, traceability   | ISO 27001 A.12.1.1              |
| **SBOM Generation**  | SPDX format, all dependencies | Supply chain transparency   | Â§4.4 Supply Chain Security      |
| **Build Provenance** | SLSA Level 3 attestation      | Build integrity             | SLSA Framework                  |
| **SBOM Attestation** | Cryptographic signing         | Artifact authenticity       | Non-repudiation                 |
| **Verification**     | gh attestation verify         | Release validation          | Trust establishment             |

### Documentation-as-Code Benefits

**Integrity:**

- âœ… Generated automatically from code and tests
- âœ… Version controlled with full git history
- âœ… Reproducible from any release tag
- âœ… Part of attested release artifacts

**Transparency:**

- âœ… Public access via GitHub Pages
- âœ… Real-time updates with every release
- âœ… Complete test coverage visibility
- âœ… API documentation always current

**Compliance:**

- âœ… ISMS Â§3.2 architecture documentation requirement
- âœ… ISO 27001 A.12.1.1 documented procedures
- âœ… Audit trail for all documentation changes
- âœ… Eliminates documentation drift

### ISMS Evidence

- **Workflow**: [release.yml](.github/workflows/release.yml)
- **Documentation**:
  [docs/index.html](https://hack23.github.io/euparliamentmonitor/docs/)
- **Process Guide**: [docs/RELEASE_PROCESS.md](docs/RELEASE_PROCESS.md)
- **Workflow Documentation**: [WORKFLOWS.md](WORKFLOWS.md#5-release-workflow)
- **Attestations**:
  [GitHub Attestations](https://github.com/Hack23/euparliamentmonitor/attestations)
- **Policy**:
  [ISMS Secure Development Â§3.2](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Secure_Development_Policy.md#32-architecture-documentation)

---

## ğŸ“š References

### Internal Documentation
- [SECURITY_ARCHITECTURE.md](SECURITY_ARCHITECTURE.md) - Security architecture and threat model
- [WORKFLOWS.md](WORKFLOWS.md) - Current CI/CD workflows
- [FUTURE_WORKFLOWS.md](FUTURE_WORKFLOWS.md) - Planned enhancements
- [DATA_MODEL.md](DATA_MODEL.md) - Data structures and schemas
- [ARCHITECTURE.md](ARCHITECTURE.md) - System architecture and C4 models

### ISMS Policies (Hack23)
- [Information Security Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Information_Security_Policy.md) - Overarching security governance
- [Secure Development Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Secure_Development_Policy.md) - Secure coding practices
- [Access Control Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Access_Control_Policy.md) - Authentication and authorization
- [Vulnerability Management Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Vulnerability_Management_Policy.md) - Vulnerability handling
- [Incident Response Policy](https://github.com/Hack23/ISMS-PUBLIC/blob/main/Incident_Response_Policy.md) - Incident management

### Standards and Frameworks
- [ISO 27001:2022](https://www.iso.org/standard/27001) - Information security management
- [NIST Incident Response (SP 800-61)](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final) - Incident handling
- [NIST CSF 2.0](https://www.nist.gov/cyberframework) - Cybersecurity Framework
- [CIS Controls v8.1](https://www.cisecurity.org/controls) - Security best practices
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/) - Security testing
- [OWASP ASVS](https://owasp.org/www-project-application-security-verification-standard/) - Application security verification
- [SLSA Framework](https://slsa.dev/) - Supply chain security
- [GDPR](https://gdpr.eu/) - Data protection regulation
- [NIS2 Directive](https://digital-strategy.ec.europa.eu/en/policies/nis2-directive) - Network and information security

### Tools and Technologies
- [GitHub Actions Security](https://docs.github.com/en/actions/security-guides) - CI/CD security
- [CodeQL](https://codeql.github.com/) - Semantic code analysis
- [Dependabot](https://github.com/dependabot) - Dependency management
- [Sigstore](https://www.sigstore.dev/) - Artifact signing
- [SPDX](https://spdx.dev/) - Software bill of materials

---

**Document Status**: Active  
**Next Review**: 2026-05-24  
**Owner**: Development Team, Hack23 AB  
**Classification**: Public  
**Version**: 1.1
